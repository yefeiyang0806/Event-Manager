{% extends "bootstrap/base.html" %}
{% block title %}{{ first_name }}'s Home Page{% endblock %}
{% block body %}
  {{super()}}
  <link href="{{url_for('static', filename='css/dashboard.css')}}" rel="stylesheet">
  <!--link href="{{url_for('static', filename='css/register.css')}}" rel="stylesheet"-->
  <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

  {% include 'navbar.html' %}
  <div class="container-fluid">
    <div class="row">
      {% include 'side_bar.html' %}
      <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        <h1 class="page-header">Manage Roles</h1>
        <br />
        <div class="table-responsive">
          {% if not roles %}
            <div class="panel panel-warning">
              <div class="panel-heading">
                <h2 class="panel-title">No Roles yet.</h2>
              </div>
              <div class="panel-body">
                You can <a href="/role/create">create new role here</a>.<br />
                More actions are available on the left-hand side navigator bar.
              </div>
            </div>
         {% else %}
            {% for role in roles %}
              <h3 class="event_title text-muted">{{ role.rolename }}</h3>
              <h4 class="task_title text-success">&nbsp;&nbsp;Create by <strong>{{role.create_by}}</strong></h4>
              <table class="table">
                <tbody>
                  <tr>
                    <td>Description: {{role.description}}</td>
                    <td>                                 </td>
                  
                    <!--c:if test="${ diet_tasks[i-1].state != 'Not Started'}"-->
                      <td><a class="btn btn-info" role="button" href="/role/modify/{{ role.uuid }}">Modify</a></td>
                    <!--/c:if-->
                    <!--c:if test="${ diet_tasks[i-1].state == 'Not Started'}">
                    <td><a class="btn btn-info disabled" role="button" href="/project/food/modify_diet_task?id=${ diet_tasks[i-1].id }">Performance</a></td>
                    </c:if-->
                  </tr>
                  <tr>
                    <td>Create Date: {{ role.create_date }}</td>
                    <!--c:if test="${ diet_tasks[i-1].state != 'Expired'}"-->
                    <td colspan="2">Create Time: {{ role.create_time }}</td>
                    <!--/c:if>
                    <c:if test="${ diet_tasks[i-1].state == 'Expired'}">
                      <td>Finished at: ${ diet_tasks[i-1].finish }</td>
                      <td>Total Calorie: ${ totalCalories[i-1] }</td>
                    </c:if-->
                    <td><button class="btn btn-info delete" role="button" name="{{ role.uuid }}">Delete</button></td>
                  </tr>
                </tbody>
              </table>
              <br />
                
            {% endfor %}
          {% endif %}
        </div>
        <div style="display:none" id='confirm' title='Delete the selected event?'>
          <p>Do you want to delete the selected role?</p>
        </div>
      </div>
    </div>
  </div>

  <script src="{{url_for('static', filename='js/jquery-1.11.3.js')}}"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <script>
    $(document).ready(function() {
      
      $(".delete").click(function(){
        var role_uuid = $(this).attr('name');
        console.log("hello");
        $( "#confirm" ).dialog({
          resizable: false,
          height:200,
          modal: true,
          buttons: {
            Delete: function() {
              $( this ).dialog( "close" );
              console.log("role id is :" + role_uuid);
              $(window.location).attr('href', '/role/delete?role_uuid='+role_uuid);
            },
            Cancel: function() {
              $( this ).dialog( "close" );
            }
          }
        });
        console.log("opened");
      });
  
    });
  </script>

{% endblock %}